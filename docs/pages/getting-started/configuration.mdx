---
title: Configuration - agentful
description: Configure agentful for your project.
---

# Configuration

Customize agentful to match your workflow.

## Overview

You can modify:
- **Agents** - Add, remove, or specialize agents
- **Commands** - Create custom slash commands
- **Skills** - Add domain-specific capabilities
- **Settings** - Configure hooks and permissions
- **Product Structure** - Choose flat or hierarchical

**Configuration files**:
```
.claude/
├── product/
│   ├── index.md        # Product spec (hierarchical)
│   └── domains/        # Domain-specific specs
├── agents/             # Agent definitions
├── commands/           # Slash commands
├── skills/             # Domain skills
└── settings.json       # Hooks and permissions
```

<div className="callout callout-warning">
  **Updating Configuration Files**

  While you can manually edit any files in `.claude/`, use [`/agentful-update`](/commands/agentful-update) when updating agentful to newer versions. This command safely updates your configuration files while preserving your customizations.
</div>

## Product Structure

agentful uses a hierarchical structure for organizing product specifications.

### Hierarchical Structure

Best for large projects, team collaboration.

```
.claude/product/
├── index.md              # Product overview
└── domains/
    ├── authentication/
    │   ├── index.md      # Domain overview
    │   └── features/
    │       ├── login.md
    │       └── register.md
    └── user-management/
        └── index.md
```

**`.claude/product/index.md`**:
```markdown
# My App

## Domains
- Authentication (CRITICAL)
- User Management (HIGH)
```

**`.claude/product/domains/authentication/index.md`**:
```markdown
# Authentication Domain

## Features

### 1. Login - CRITICAL
**Description**: User login

**Acceptance Criteria**:
- [ ] Email/password input
- [ ] JWT generation
```

### When to Use Domains

For complex projects with multiple business domains, organize into domain subdirectories.
For simpler projects, keep all features in `index.md`.

## Settings Configuration

**Location**: `.claude/settings.json`

```json
{
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "Edit|Write",
        "hooks": [
          {
            "type": "command",
            "command": "npx tsc --noEmit 2>&1 | head -5 || true"
          }
        ]
      }
    ],
    "UserPromptSubmit": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "if [ -f .agentful/state.json ]; then jq -r '.current_phase // \"idle\"' .agentful/state.json 2>/dev/null || echo 'idle'; else echo 'idle'; fi"
          }
        ]
      }
    ]
  },
  "permissions": {
    "allow": [
      "Bash(npm:*)",
      "Bash(npx:*)",
      "Bash(node:*)",
      "Bash(git:*)",
      "Bash(jq:*)"
    ],
    "deny": [
      "Bash(rm -rf /)",
      "Bash(dd:*)",
      "Bash(mkfs:*)"
    ]
  }
}
```

### Hooks

**PostToolUse Hook** - Runs after file edits:
```json
{
  "matcher": "Edit|Write",
  "hooks": [
    {
      "type": "command",
      "command": "npx tsc --noEmit 2>&1 | head -5 || true"
    }
  ]
}
```

Customize for your language:
```json
// Python
{"command": "python -m mypy . 2>&1 | head -5 || true"}

// Go
{"command": "go build ./... 2>&1 | head -5 || true"}

// Disable
{"command": "echo 'Type checking disabled'"}
```

### Permissions

**Allow List**:
```json
"allow": [
  "Bash(npm:*)",
  "Bash(pnpm:*)",     // Add pnpm
  "Bash(yarn:*)",     // Add yarn
  "Bash(python:*)",   // Add Python
  "Bash(docker:*)"    // Add Docker
]
```

**Deny List**:
```json
"deny": [
  "Bash(rm -rf /)",   // Prevent root deletion
  "Bash(dd:*)",       // Prevent disk ops
  "Bash(mkfs:*)"      // Prevent formatting
]
```

## Agent Configuration

### Customize Existing Agents

**Location**: `.claude/agents/`

Agents available:
- `orchestrator.md` - Main coordinator
- `architect.md` - Tech stack analyzer
- `backend.md` - Backend specialist
- `frontend.md` - Frontend specialist
- `tester.md` - Test writer
- `reviewer.md` - Quality validator
- `fixer.md` - Issue fixer

#### Example: Customize Frontend Agent

**File**: `.claude/agents/frontend.md`

Add to scope:
```markdown
## Your Scope

- **UI Components** - Reusable components
- **Pages** - Route pages
- **Animation** - Framer Motion, GSAP  ← NEW
```

Remove from scope:
```markdown
## NOT Your Scope

- State Management → @state-manager  ← DELEGATE
```

#### Example: Customize Quality Gates

**File**: `.claude/agents/reviewer.md`

Add custom gate:
```markdown
## Quality Gates

- All tests passing
- No type errors
- Test coverage ≥ 80%
- Bundle size < 200KB (gzip)  ← NEW
- Lighthouse score ≥ 90       ← NEW
```

### Create New Agents

**File**: `.claude/agents/database.md`

```markdown
---
name: database
version: 1.0.0
---

# Database Agent

You are the **Database Agent**. You handle database operations.

## Your Scope

- Schema Design - Models and relationships
- Migrations - Database migrations
- Queries - Complex queries
- Seeding - Test data

## NOT Your Scope

- API routes → @backend
- Tests → @tester

## Rules

1. ALWAYS use TypeScript
2. ALWAYS create migrations for schema changes
3. ALWAYS use transactions for multi-step operations
4. NEVER expose raw queries to API

## After Implementation

Report:
- Schemas created/modified
- Migrations run
- What needs testing
```

Use with:
```
@database, please create the User model
```

## Command Configuration

**Location**: `.claude/commands/`

Commands:
- `agentful-generate.md` - Generate specialized agents
- `agentful-status.md` - Check progress
- `agentful-decide.md` - Answer decisions
- `agentful-validate.md` - Run quality checks

### Create Custom Command

**File**: `.claude/commands/agentful-deploy.md`

```markdown
---
name: agentful-deploy
description: Deploy project to production
---

# Deploy Command

Deploys after validation.

## Usage

```
/agentful-deploy
```

## What It Does

1. Runs validation (`/agentful-validate`)
2. Checks quality gates
3. Runs build
4. Deploys to platform
5. Runs smoke tests

## Requirements

- All quality gates pass
- Build succeeds
- No uncommitted changes

## Platforms

- Vercel: `vercel deploy --prod`
- Netlify: `netlify deploy --prod`
- Railway: `railway up`
- Custom: `npm run deploy`

## Configuration

Add to .claude/product/index.md:
```markdown
## Deployment
- Platform: Vercel
- Build Command: npm run build
- Output Directory: .next
```
```

Use with:
```
/agentful-deploy
```

## Skills Configuration

**Location**: `.claude/skills/`

### Create Testing Skill

**File**: `.claude/skills/testing/SKILL.md`

```markdown
---
name: testing
version: 1.0.0
---

# Testing Skill

Provides testing capabilities.

## What This Skill Does

- Writes unit tests
- Writes integration tests
- Writes E2E tests
- Measures coverage

## Usage

```
@tester use testing skill to write tests for UserService
```

## Test Templates

### Unit Test (Vitest)

```typescript
import { describe, it, expect } from 'vitest';
import { UserService } from '../UserService';

describe('UserService', () => {
  it('should create a user', async () => {
    const user = await UserService.create({
      email: 'test@example.com',
      name: 'Test User'
    });

    expect(user).toHaveProperty('id');
    expect(user.email).toBe('test@example.com');
  });
});
```

## Coverage Targets

- Unit tests: 90%+ coverage
- Integration tests: Critical paths
- E2E tests: User journeys

## Best Practices

1. Test behavior, not implementation
2. Use descriptive names
3. Follow AAA pattern (Arrange, Act, Assert)
4. Mock external dependencies
5. Keep tests fast
```

## Platform-Specific Configuration

### Next.js

**next.config.js**:
```javascript
const nextConfig = {
  reactStrictMode: true,
  swcMinify: true,
  images: {
    domains: ['example.com'],
  },
  experimental: {
    serverActions: true,
  },
}

module.exports = nextConfig
```

### TypeScript

**tsconfig.json**:
```json
{
  "compilerOptions": {
    "target": "ES2020",
    "lib": ["dom", "dom.iterable", "esnext"],
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "jsx": "preserve",
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": ["**/*.ts", "**/*.tsx"],
  "exclude": ["node_modules"]
}
```

## Quality Gate Configuration

### Coverage Thresholds

**Update**: `.claude/agents/reviewer.md`

```markdown
## Coverage Thresholds

- Overall: ≥ 80%
- Critical paths: ≥ 90%
- UI components: ≥ 70%
- Utilities: ≥ 95%
```

**Vitest config**:
```typescript
// vitest.config.ts
export default defineConfig({
  test: {
    coverage: {
      provider: 'v8',
      thresholds: {
        lines: 80,
        functions: 80,
        branches: 80,
        statements: 80,
      },
    },
  },
})
```

## Troubleshooting

### Configuration Not Loading

1. Restart Claude Code:
```bash
exit
claude
```

2. Check file format:
- Valid Markdown (.md)
- Valid frontmatter
- No JSON syntax errors

3. Verify paths:
```bash
ls -la .claude/agents/
ls -la .claude/commands/
ls -la .claude/settings.json
```

### Agent Not Responding

1. Check file exists in `.claude/agents/`
2. Verify agent name:
```bash
ls .claude/agents/
# Reference: @database (not @database.md)
```

## Best Practices

### Version Control

Commit `.claude/` to git:
```bash
git add .claude/
git commit -m "Configure agentful"
```

Ignore `.agentful/` (runtime state):
```bash
# Already in .gitignore
.agentful/
```

### Document Changes

Create `CONFIG.md`:
```markdown
# agentful Configuration

## Custom Agents
- @database - Database operations
- @analytics - Analytics tracking

## Custom Commands
- /agentful-deploy - Deployment workflow

## Modified Agents
- @frontend - Added animation support
- @reviewer - Added bundle size checks
```

### Test Gradually

1. Use defaults first
2. Make small changes
3. Test after each change
4. Document what works

## Next Steps

<div className="grid gap-4 md:grid-cols-2 mt-8">

<div>

### Agent Reference
Learn about each agent
[Agents Guide](/agents/)

</div>

<div>

### Command Reference
Learn about all commands
[Commands Guide](/commands/)

</div>

</div>
